name: "Terraform infrastructure deployment"
concurrency:
  group: infrastructure

on:
  push:
    branches:
      - dev
      - staging
      - production
  
  workflow_dispatch:
  pull_request:
    
jobs:
  terraform:
   name: "Terraform"
   runs-on: ubuntu-22.04
   steps:
     - name: Checkout
       uses: actions/checkout@v2

     - name: Setup Terraform
       uses: hashicorp/setup-terraform@v1
       with:
         terraform_version: $(cat .terraform-version)
         terraform_wrapper: true